<% content_for :head do %>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
<% end %>

<% content_for :page_header do %>
  <h2 class="page-title">
    Convict Court Locations
  </h2>
<% end %>

<div class="bordered" style="clear: both;">
  <div id="map_canvas" style="width: 300px; height: 450px"></div> 
</div>

<script>
  
  $(document).ready(function() {
    var myLatlng = new google.maps.LatLng(54.55, -4.1);
    var myOptions = {
      zoom: 5,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    var geocoder = new google.maps.Geocoder();

    <% @counties.each do |county_map| %>
      <% county = County.find_by_name(county_map[:court_county]) %>
      new google.maps.Marker({
        position: new google.maps.LatLng(<%= county.latitude %>, <%= county.longitude %>),
            map: map,
            title:"<%= county.name %> <%= county_map[:convicts] %> Convicts"
      });
    <% end %>

  });

</script>


  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Convicts</th>
      </tr>
    </thead>
    <tbody>
      <% @counties.each do |county_map| %>
        <tr>
          <td><%= link_to(county_map[:court_county], convicts_path(:court_county => county_map[:court_county])) %></td>
          <td><%= county_map[:convicts] %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
